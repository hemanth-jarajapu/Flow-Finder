<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_ux_data_broker_transform">
    <sys_ux_data_broker_transform action="INSERT_OR_UPDATE">
        <acl_failure_result/>
        <api_name>x_350851_flow_fi_0.Action Search Data Broker</api_name>
        <description/>
        <mutates_server_data>false</mutates_server_data>
        <name>Action Search Data Broker</name>
        <output_schema/>
        <private>false</private>
        <props>[&#13;
  {&#13;
    "label": "Connection/Credential Alias",&#13;
    "name": "connection_cred_id",&#13;
    "description": "Sys ID of the connection/credential alias",&#13;
    "readOnly": false,&#13;
    "fieldType": "string",&#13;
    "mandatory": true,&#13;
    "defaultValue": ""&#13;
  },&#13;
{&#13;
    "label": "Script Snippet",&#13;
    "name": "script_snippet",&#13;
    "description": "A code snippet that might be part of a script step within the action",&#13;
    "readOnly": false,&#13;
    "fieldType": "string",&#13;
    "mandatory": true,&#13;
    "defaultValue": ""&#13;
  }&#13;
 ]</props>
        <required_translations>[ {
  "message" : "A code snippet that might be part of a script step within the action",
  "comment" : ""
}, {
  "message" : "Connection/Credential Alias",
  "comment" : ""
}, {
  "message" : "Script Snippet",
  "comment" : ""
}, {
  "message" : "Sys ID of the connection/credential alias",
  "comment" : ""
} ]</required_translations>
        <schema_version>1.0.0</schema_version>
        <script><![CDATA[function transform(input) {
	var connection_cred_id = input.connection_cred_id;
	var script_snippet = input.script_snippet;

	var output = {
		"query": ""
	};

	var actions = new GlideRecord("sys_hub_action_type_definition");
	actions.orderBy("name");
	if (!connection_cred_id && !script_snippet) {
		output.query = actions.getEncodedQuery();
	}

	var variableValues = new GlideRecord("sys_variable_value");
	var usedValues = [];
	if (connection_cred_id) {
		usedValues = [];
		variableValues.addQuery("document=sys_hub_step_instance^variable.labelLIKEcredential alias^ORvariable.labelLIKEconnection alias^value=" + connection_cred_id);
		variableValues.query();
		var actionsUsingGivenAlias = [];
		while (variableValues.next()) {
			if (usedValues.indexOf(variableValues.getUniqueValue()) > -1) {
				continue;
			}

			if (variableValues.document_key.action.sys_class_name == "sys_hub_action_type_definition") {
				actionsUsingGivenAlias.push(variableValues.document_key.action);
				usedValues.push(variableValues.getUniqueValue());
			}
		}

		actions.addQuery("sys_idIN" + actionsUsingGivenAlias);
	}

	output.query = actions.getEncodedQuery();
	return output;
}]]></script>
        <sys_class_name>sys_ux_data_broker_transform</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2023-07-24 14:09:00</sys_created_on>
        <sys_id>2be6d16897943110974bbf1e6253af56</sys_id>
        <sys_mod_count>6</sys_mod_count>
        <sys_name>Action Search Data Broker</sys_name>
        <sys_package display_value="Flow Finder" source="x_350851_flow_fi_0">18d672eb97132110974bbf1e6253afc8</sys_package>
        <sys_policy/>
        <sys_scope display_value="Flow Finder">18d672eb97132110974bbf1e6253afc8</sys_scope>
        <sys_update_name>sys_ux_data_broker_transform_2be6d16897943110974bbf1e6253af56</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2023-07-31 14:52:51</sys_updated_on>
    </sys_ux_data_broker_transform>
    <sys_translated_text action="delete_multiple" query="documentkey=2be6d16897943110974bbf1e6253af56"/>
</record_update>
